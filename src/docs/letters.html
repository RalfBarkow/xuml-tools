<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>jQuery UI Draggable - Snap to element or grid</title>
	<link rel="stylesheet" href="http://jqueryui.com/themes/base/jquery.ui.all.css">
	<script src="http://code.jquery.com/jquery-1.7.2.js"></script>
	<script src="http://code.jquery.com/ui/1.8.22/jquery-ui.min.js"></script>
	<link rel="stylesheet" href="http://jqueryui.com/demos/demos.css">
	<!-- 	//background-image: url(tile.png); -->
	<style>
	.all { border: 1px solid black;padding-bottom:50px; }
	.letter { width:75px;height:75px; font-size:5em; background-color:yellow;margin-top:20px; padding-left:35px;padding-top:20px; } 
	.top {z-index: 2; position: relative}
	.bottom {z-index: 1; position: relative}
	.word { list-style-type: none; margin: 0; padding: 3 3 3; margin-right: 10px; position:absolute; border:0px solid red;}
	.word li { display: inline-block;}
	.word-handle { cursor:move; width:30px; height:30px; background-color:gray; position:relative;left:0px;top:0px;}
	.next { height:55px; text-align:center; font-size:2em; }
	#snaptarget { height: 140px; }
	</style>
	<script>
	function touchHandler(event) {
	    var touches = event.changedTouches,
	    first = touches[0],
	    type = "";

	    switch(event.type)
		{
		    case "touchstart": type = "mousedown"; break;
		    case "touchmove":  type="mousemove"; break;        
		    case "touchend":   type="mouseup"; break;
		    default: return;
		}
	    var simulatedEvent = document.createEvent("MouseEvent");
	    simulatedEvent.initMouseEvent(type, true, true, window, 1,
		                  first.screenX, first.screenY,
		                  first.clientX, first.clientY, false,
		                  false, false, false, 0/*left*/, null);

	    first.target.dispatchEvent(simulatedEvent);
	    event.preventDefault();
	}

	function makeTouchable() {
		document.addEventListener("touchstart", touchHandler, true);
		document.addEventListener("touchmove", touchHandler, true);
		document.addEventListener("touchend", touchHandler, true);
		document.addEventListener("touchcancel", touchHandler, true); 
	}

	function styleWords() {
		$( ".word" ).sortable({
				connectWith: ".connectedSortable",
				items: "li:not(.ui-state-disabled)"
			}).disableSelection();
		$( ".word-container" ).draggable(
			{ handle: ".word-handle",
			 // containment:".all",
			  scroll: false
			  });
		$( ".letter" ).click(function() {
    	    		$(this).addClass('top').removeClass('bottom');
    	    		$(this).siblings().removeClass('top').addClass('bottom');
		});
	}

	$(function() {
		styleWords();
		$( "#word2").offset({ top: 200, left: 300});
		$(window).resize(function() {
			var viewportWidth = $(window).width();
			var viewportHeight = $(window).height();
			$( ".all").height(viewportHeight-80).width(viewportWidth-30);
		});
		var  letters = 				'AAAAAAAAABBCCDDDDEEEEEEEEEEEEFFGGGHHIIIIIIIIIJKLLLLMMNNNNNNOOOOOOOOPPQRRRRRRSSSSTTTTTTUUUUVVWWXYYZ';
		var x = 0;
		$( "#next").button({
     			icons: {
				primary: 'ui-icon-plus'}
			}).click(function() {
				
				var rnum = Math.floor(Math.random() * letters.length);
				var letter = letters.substring(rnum,rnum+1);
				letters = letters.replace(letter,'');
				var s = '<div id="word" class="word-container">'
				      + '<div class="word-handle"></div>'
/*  + '<li class="word-handle ui-state-disabled"></li>' */
				      + '<ul class="word connectedSortable">'
				      + '<li class="letter ui-state-default">' 
				     + letter 
				      + '</li></ul></div>';
				var y = $(window).height()-100;
				$( s).insertAfter("#start").offset({ top:y, left:x });
				x = x + 75;
				styleWords();
				if (letters.length==0) {
					$(" #next").text("No more!");
					$(" #next").button({ icons: {
						primary: 'ui-icon-plus'},
						disabled: true });
				}
		});
		$(window).resize();
		makeTouchable();
	});
	</script>
</head>
<body>

<div id="all" class="all">

<br clear="both" />
<div style="text-align: center;"><button id="next" class="ui-state-default ui-corner-all next" type="submit">Next</button></div>

<div id="start"></div>

<!--
<div id="word1" class="word-container">
<ul class="word connectedSortable">
<li class="word-handle ui-state-disabled">-</li>
<li class="letter ui-state-default">A</li>
<li class="letter ui-state-default">B</li>
<li class="letter ui-state-default">C</li>
</ul>
</div>


<div id="word2" class="word-container">
<ul class="word connectedSortable">
<li class="word-handle ui-state-disabled"></li>
<li class="letter ui-state-default">T</li>
<li class="letter ui-state-default">O</li>
<li class="letter ui-state-default">R</li>
<li class="letter ui-state-default">E</li>
</ul>
</div>

<div id="word3" class="word-container">
<ul class="word connectedSortable">
<li class="word-handle ui-state-disabled"></li>
<li class="letter ui-state-default">A</li>
</ul>
</div>

<div id="word4" class="word-container">
<ul class="word connectedSortable">
<li class="word-handle ui-state-disabled"></li>
<li class="letter ui-state-default">M</li>
</ul>
</div>

-->

</div>


</body>
</html>


